<!-- <div class="drug-list-page">
    <h2>Drug List</h2>
  
    <button (click)="showAddForm = !showAddForm" class="toggle-form-btn">
      {{ showAddForm ? 'Cancel' : 'Add Drug' }}
    </button>
  
     Add/Edit Form 
    <div *ngIf="showAddForm" class="form-box">
      <h3>{{ editMode ? 'Edit Drug' : 'Add New Drug' }}</h3>
      <form (ngSubmit)="editMode ? updateDrug() : addDrug()" #drugForm="ngForm">
        <div class="form-row">
          <input type="text" name="name" [(ngModel)]="newDrug.name" placeholder="Name" required />
        </div>

        <div class="form-row">
          <textarea name="description" [(ngModel)]="newDrug.description" placeholder="Description"></textarea>
        </div>
        <div class="form-row">
          <input type="number" name="price" [(ngModel)]="newDrug.price" placeholder="Price (‚Çπ)" required />
          <input type="text" name="categoryName" [(ngModel)]="newDrug.categoryName" placeholder="Category Name" required />
        </div>
        <button type="submit" [disabled]="drugForm.invalid" class="submit-btn">
          {{ editMode ? 'Update' : 'Submit' }}
        </button>
      </form>
    </div>
  
     Drug Table 
    <div *ngIf="drugs.length === 0" class="no-drugs">No drugs found.</div>
  
    <div class="table-wrapper" *ngIf="drugs.length > 0">
      <table class="drug-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Price (‚Çπ)</th>
            <th>Stock </th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let drug of drugs">
            <td>{{ drug.name }}</td>
            <td>{{ drug.description }}</td>
            <td>{{ drug.price | number: '1.2-2' }}</td>
            <td>{{ drug.stock }}</td>
            <td>
              <button (click)="editDrug(drug)">Edit</button>
              <button (click)="deleteDrug(drug.drugId)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
   -->
<!-- 

   <div class="drug-list-container">
    <div class="header-row">
      <h2 class="page-title">Drug List</h2>
      <button (click)="showAddForm = !showAddForm" class="add-btn">
        {{ showAddForm ? 'Cancel' : 'Add' }}
      </button>
    </div>
  
 
    <div *ngIf="showAddForm" class="drug-form-container">
      <h3>{{ editMode ? 'Edit Drug' : 'Add New Drug' }}</h3>
      <form (ngSubmit)="editMode ? updateDrug() : addDrug()" #drugForm="ngForm">
        <div class="form-grid">
          <input type="text" name="name" [(ngModel)]="newDrug.name" placeholder="Name" required />
      
          <input type="number" name="categoryName" [(ngModel)]="newDrug.stock" placeholder="Stock" required />
        </div>
        <div class="form-grid">
          <input type="number" name="price" [(ngModel)]="newDrug.price" placeholder="Price (‚Çπ)" required />
        </div>
        <div class="form-grid">
          <textarea name="description" [(ngModel)]="newDrug.description" placeholder="Description"></textarea>
        </div>
        <button type="submit" [disabled]="drugForm.invalid" class="submit-btn">
          {{ editMode ? 'Update' : 'Submit' }}
        </button>
      </form>
    </div>
  
   
    <div *ngIf="drugs.length === 0" class="no-drugs">No drugs found.</div>
  
    <div class="table-container" *ngIf="drugs.length > 0">
      <table class="drug-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Price (‚Çπ)</th>
            <th>Stock</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let drug of drugs">
            <td>{{ drug.name }}</td>
            <td>{{ drug.description }}</td>
            <td>{{ drug.price | number: '1.2-2' }}</td>
            <td>{{ drug.stock }}</td>
            <td class="action-buttons">
              <button class="edit-btn" (click)="editDrug(drug)">
                ‚úèÔ∏è Edit
              </button>
        
                <button class="delete-btn"  (click)="deleteDrug(drug.drugId)">

                üóë Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
   -->

   <mat-card class="drug-list-card mat-elevation-z2">
  <!-- header with title, search & add button -->
  <mat-toolbar color="primary" class="header-toolbar">
    <span class="title">Drug List</span>
    <span class="spacer"></span>
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Search</mat-label>
      <input
        matInput
        [(ngModel)]="searchQuery"
        (ngModelChange)="fetchDrugs(searchQuery)"
        placeholder="Type to filter..."
      >
      <button
        *ngIf="searchQuery"
        matSuffix
        mat-icon-button
        aria-label="Clear"
        (click)="searchQuery=''; fetchDrugs('')"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    <button mat-flat-button color="accent" (click)="showAddForm = !showAddForm">
      <mat-icon>{{ showAddForm ? 'close' : 'add' }}</mat-icon>
      {{ showAddForm ? 'Cancel' : (editMode ? 'Cancel Edit' : 'Add Drug') }}
    </button>
  </mat-toolbar>

  <!-- inline add/edit form in an expansion panel -->
  <mat-expansion-panel [expanded]="showAddForm" hideToggle>
    <mat-expansion-panel-header>
      <mat-panel-title>
        {{ editMode ? '‚úèÔ∏è Edit Drug' : '‚ûï Add New Drug' }}
      </mat-panel-title>
    </mat-expansion-panel-header>

    <form
      class="drug-form"
      (ngSubmit)="editMode ? updateDrug() : addDrug()"
      #drugForm="ngForm"
    >
      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Name</mat-label>
          <input matInput required name="name" [(ngModel)]="newDrug.name">
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Stock</mat-label>
          <input
            matInput
            type="number"
            required
            name="stock"
            [(ngModel)]="newDrug.stock"
          >
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Price (‚Çπ)</mat-label>
          <input
            matInput
            type="number"
            required
            name="price"
            [(ngModel)]="newDrug.price"
          >
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description</mat-label>
          <textarea
            matInput
            name="description"
            [(ngModel)]="newDrug.description"
            rows="3"
          ></textarea>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Drug Expiry</mat-label>
          <input
            matInput
            type="date"
            name="drugExpiry"
            [(ngModel)]="newDrug.drugExpiry"
          >
          
        </mat-form-field>
      </div>
      
      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Category</mat-label>
          <mat-select name="categoryId" [(ngModel)]="newDrug.categoryId" required>
            <mat-option *ngFor="let category of categories" [value]="category.categoryId">
              {{ category.categoryName }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="form-actions">
        <button
          mat-flat-button
          color="primary"
          [disabled]="drugForm.invalid"
          type="submit"
        >
          {{ editMode ? 'Update' : 'Submit' }}
        </button>
      </div>
    </form>
  </mat-expansion-panel>

  <!-- no-data placeholder -->
  <div *ngIf="drugs.length === 0" class="no-drugs">
    No drugs found.
  </div>

  <!-- data table -->
  <div *ngIf="drugs.length > 0" class="table-wrapper">
    <table mat-table [dataSource]="drugs" class="mat-elevation-z1">

      <!-- Name -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let d">{{ d.name }}</td>
      </ng-container>

      <!-- Description -->
      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let d">{{ d.description }}</td>
      </ng-container>

      <!-- Price -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Price (‚Çπ)</th>
        <td mat-cell *matCellDef="let d">{{ d.price | number:'1.2-2' }}</td>
      </ng-container>

      <!-- Stock -->
      <ng-container matColumnDef="stock">
        <th mat-header-cell *matHeaderCellDef>Stock</th>
        <td mat-cell *matCellDef="let d">{{ d.stock }}</td>
      </ng-container>

      <!-- Expiry -->
      <ng-container matColumnDef="expiry">
        <th mat-header-cell *matHeaderCellDef>Expiry Date</th>
        <td mat-cell *matCellDef="let d">{{ d.drugExpiry| date }}</td>
      </ng-container>

      <!-- Category -->
      <ng-container matColumnDef="category">
        <th mat-header-cell *matHeaderCellDef>Category</th>
        <td mat-cell *matCellDef="let d">{{ getCategoryName(d.categoryId) }}</td>
      </ng-container>

      <!-- Actions -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let d">
          <button mat-icon-button color="primary" (click)="editDrug(d)">
            <mat-icon>edit</mat-icon>
          </button>
          <button mat-icon-button color="warn" (click)="deleteDrug(d.drugId)">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['name','description','price','stock','expiry','category','actions']"></tr>
      <tr mat-row        *matRowDef="let row; columns: ['name','description','price','stock','expiry','category','actions'];"></tr>
    </table>
  </div>
</mat-card>
